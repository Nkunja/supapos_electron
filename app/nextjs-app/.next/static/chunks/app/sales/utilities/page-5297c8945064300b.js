(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5802],{1243:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},4229:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},5540:(e,t,s)=>{"use strict";s.d(t,{A1:()=>u,AC:()=>x,Hr:()=>h,KM:()=>i,KZ:()=>n,Nx:()=>d,SY:()=>l,aF:()=>o,dG:()=>c,vz:()=>m,wO:()=>p}),s(8102);var a=s(61778);let r="".concat("https://supa.sirnkunja.co.ke/","api/shops/"),i=async()=>{try{return(await a.default.get(r)).data}catch(e){throw Error("Failed to fetch shops.")}},l=async e=>{try{return(await a.default.get("".concat(r).concat(e,"/total_cash_spent/"))).data}catch(e){throw console.error("Failed to fetch shop total cash spent:",e),Error("Failed to fetch shop total cash spent.")}},n=async()=>{try{return(await a.default.get("".concat(r,"active_shops/"))).data}catch(e){throw Error("Failed to fetch active shops.")}},o=async()=>{try{return(await a.default.get("".concat(r,"my_shops/"))).data}catch(e){throw Error("Failed to fetch my shops.")}},d=async e=>{try{return(await a.default.get("".concat(r).concat(e,"/"))).data}catch(e){throw Error("Failed to fetch shop.")}},c=async e=>{try{return(await a.default.post(r,e)).data}catch(e){throw Error("Failed to create shop.")}},u=async(e,t)=>{try{return(await a.default.put("".concat(r).concat(e,"/"),t)).data}catch(e){throw Error("Failed to update shop.")}},x=async e=>{try{return(await a.default.delete("".concat(r).concat(e,"/"))).data}catch(e){throw Error("Failed to delete shop.")}},m=async(e,t)=>{try{return(await a.default.post("".concat(r).concat(e,"/assign_salesperson/"),t)).data}catch(e){throw Error("Failed to assign salesperson.")}},p=async(e,t)=>{try{return(await a.default.post("".concat(r).concat(e,"/remove_salesperson/"),t)).data}catch(e){throw Error("Failed to remove salesperson.")}},h=async e=>{try{return(await a.default.get("".concat(r).concat(e,"/salespersons_list/"))).data}catch(e){throw Error("Failed to fetch shop salespersons.")}}},6101:(e,t,s)=>{"use strict";s.d(t,{s:()=>l,t:()=>i});var a=s(12115);function r(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function i(...e){return t=>{let s=!1,a=e.map(e=>{let a=r(e,t);return s||"function"!=typeof a||(s=!0),a});if(s)return()=>{for(let t=0;t<a.length;t++){let s=a[t];"function"==typeof s?s():r(e[t],null)}}}}function l(...e){return a.useCallback(i(...e),e)}},13717:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},20651:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>O});var a=s(95155),r=s(12115),i=s(55868),l=s(84616),n=s(1243),o=s(40646),d=s(66932);s(8102);var c=s(61778);let u="".concat("https://supa.sirnkunja.co.ke/","api/utilities/"),x=async e=>{try{let t=new URLSearchParams;(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.page_size)&&t.append("page_size",e.page_size.toString()),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.utility_type)&&t.append("utility_type",e.utility_type),(null==e?void 0:e.source_type)&&t.append("source_type",e.source_type),(null==e?void 0:e.user)&&t.append("user",e.user.toString()),(null==e?void 0:e.shop)&&t.append("shop",e.shop.toString()),(null==e?void 0:e.inventory_item)&&t.append("inventory_item",e.inventory_item.toString()),(null==e?void 0:e.inventory_deducted)!==void 0&&t.append("inventory_deducted",e.inventory_deducted.toString()),(null==e?void 0:e.start_date)&&t.append("start_date",e.start_date),(null==e?void 0:e.end_date)&&t.append("end_date",e.end_date),(null==e?void 0:e.min_amount)&&t.append("min_amount",e.min_amount.toString()),(null==e?void 0:e.max_amount)&&t.append("max_amount",e.max_amount.toString()),(null==e?void 0:e.inventory_only)&&t.append("inventory_only","true"),(null==e?void 0:e.my_utilities)&&t.append("my_utilities","true"),(null==e?void 0:e.ordering)&&t.append("ordering",e.ordering);let s=t.toString()?"".concat(u,"?").concat(t.toString()):u;return(await c.default.get(s)).data}catch(e){throw Error("Failed to fetch utilities.")}},m=async e=>{try{return(await c.default.post(u,e)).data}catch(e){throw Error("Failed to create utility.")}},p=async(e,t)=>{try{return(await c.default.put("".concat(u).concat(e,"/"),t)).data}catch(e){throw Error("Failed to update utility.")}},h=async e=>{try{return(await c.default.delete("".concat(u).concat(e,"/"))).data}catch(e){throw Error("Failed to delete utility.")}},y=async e=>{try{let t=new URLSearchParams;(null==e?void 0:e.shop_id)&&t.append("shop_id",e.shop_id.toString()),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.low_stock_only)&&t.append("low_stock_only","true"),(null==e?void 0:e.expiring_soon)&&t.append("expiring_soon","true");let s=t.toString()?"".concat(u,"available_inventory/?").concat(t.toString()):"".concat(u,"available_inventory/");return(await c.default.get(s)).data}catch(e){throw Error("Failed to fetch available inventory.")}},v=async e=>{try{let t=new URLSearchParams;(null==e?void 0:e.start_date)&&t.append("start_date",e.start_date),(null==e?void 0:e.end_date)&&t.append("end_date",e.end_date),(null==e?void 0:e.user_id)&&t.append("user_id",e.user_id.toString()),(null==e?void 0:e.shop_id)&&t.append("shop_id",e.shop_id.toString());let s=t.toString()?"".concat(u,"statistics/?").concat(t.toString()):"".concat(u,"statistics/");return(await c.default.get(s)).data}catch(e){throw Error("Failed to fetch utility statistics.")}},g=async e=>{try{return(await c.default.post("".concat(u).concat(e,"/restore_inventory/"))).data}catch(e){throw Error("Failed to restore inventory.")}};var f=s(54416),b=s(47924),j=s(51154),N=s(4229);let _=[{value:"airtime",label:"Airtime/Phone Credit"},{value:"internet",label:"Internet Data/Bundles"},{value:"transport",label:"Transport/Travel"},{value:"fuel",label:"Fuel"},{value:"stationery",label:"Stationery/Office Supplies"},{value:"marketing",label:"Marketing Materials"},{value:"entertainment",label:"Client Entertainment"},{value:"meals",label:"Meals/Food"},{value:"accommodation",label:"Accommodation"},{value:"maintenance",label:"Equipment Maintenance"},{value:"electricity",label:"Electricity/Power"},{value:"water",label:"Water"},{value:"rent",label:"Rent/Facility"},{value:"insurance",label:"Insurance"},{value:"licenses",label:"Licenses/Permits"},{value:"software",label:"Software/Subscriptions"},{value:"equipment",label:"Equipment Purchase"},{value:"repairs",label:"Repairs/Fixing"},{value:"consultation",label:"Consultation/Professional Services"},{value:"training",label:"Training/Development"},{value:"inventory_usage",label:"Inventory Item Usage"},{value:"other",label:"Other Utilities"}],w=[{value:"cash",label:"Cash From Shop"},{value:"inventory",label:"From Inventory Stock"},{value:"external",label:"External Provider"},{value:"company",label:"Company Provided"}];var S=s(97168),A=s(89852),k=s(82714),F=s(49026),C=s(88482),E=s(38543);let q=e=>{let{initialData:t,onSuccess:s,onClose:i,isEmbedded:l,shops:d}=e,[c,u]=(0,r.useState)({title:(null==t?void 0:t.title)||"",utility_type:(null==t?void 0:t.utility_type)||"other",source_type:(null==t?void 0:t.source_type)||"cash",description:(null==t?void 0:t.description)||"",amount:(null==t?void 0:t.amount)||0,inventory_item:(null==t?void 0:t.inventory_item)||void 0,quantity_used:(null==t?void 0:t.quantity_used)||1,shop:(null==t?void 0:t.shop)||void 0,Extra_Confirmation:(null==t?void 0:t.Extra_Confirmation)||"",purpose:(null==t?void 0:t.purpose)||"",notes:(null==t?void 0:t.notes)||"",expense_date:(null==t?void 0:t.expense_date)?new Date(t.expense_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0]}),[x,m]=(0,r.useState)({}),[p,h]=(0,r.useState)([]),[v,g]=(0,r.useState)([]),[q,M]=(0,r.useState)(""),[T,z]=(0,r.useState)(!1),[R,U]=(0,r.useState)(!1),[D,I]=(0,r.useState)(null),[O,P]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{U(!0);try{let e=await y();console.log("Full inventory response:",e);let t=Array.isArray(e)?e:e.results||e.data||e.items||[];console.log("Parsed inventory items:",t),h(t),g(t)}catch(t){let e=t.message||"Failed to load inventory items";console.error("Inventory fetch error:",t),m(t=>({...t,inventory_item:e})),h([]),g([])}finally{U(!1)}})(),t?u({title:t.title,utility_type:t.utility_type,source_type:t.source_type,description:t.description||"",amount:t.amount,inventory_item:t.inventory_item,quantity_used:t.quantity_used,shop:t.shop,Extra_Confirmation:t.Extra_Confirmation||"",purpose:t.purpose||"",notes:t.notes||"",expense_date:t.expense_date?new Date(t.expense_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0]}):u({title:"",utility_type:"other",source_type:"cash",description:"",amount:0,inventory_item:void 0,quantity_used:1,shop:void 0,Extra_Confirmation:"",purpose:"",notes:"",expense_date:new Date().toISOString().split("T")[0]}),m({}),I(null),P(""),M(""),g(p)},[t,l]),(0,r.useEffect)(()=>{g(p.filter(e=>e.product_name.toLowerCase().includes(q.toLowerCase())||e.batch_number&&e.batch_number.toLowerCase().includes(q.toLowerCase())))},[q,p]);let $=e=>{let{name:t,value:s}=e.target,a={...c,[t]:""===s?void 0:"amount"===t||"quantity_used"===t?Number(s):s};"utility_type"===t&&"inventory_usage"===s&&(a={...a,source_type:"inventory"}),u(a),m(e=>({...e,[t]:void 0})),D&&I(null),O&&P("")},L=async e=>{if(e.preventDefault(),(()=>{let e={};return c.title||(e.title="Title is required"),c.utility_type||(e.utility_type="Utility type is required"),c.source_type||(e.source_type="Source type is required"),"inventory"!==c.source_type||c.inventory_item||(e.inventory_item="Inventory item is required for inventory-based utilities"),"inventory"===c.source_type&&(!c.quantity_used||c.quantity_used<1)&&(e.quantity_used="Quantity used must be at least 1"),"inventory"!==c.source_type&&(!c.amount||c.amount<=0)&&(e.amount="Amount must be greater than 0 for non-inventory utilities"),c.expense_date||(e.expense_date="Expense date is required"),c.description||(e.description="Description is required"),m(e),0===Object.keys(e).length})()){z(!0),I(null),P("");try{await s(c),E.oR.success(t?"Utility updated successfully!":"Utility created successfully!"),P(t?"Utility updated successfully!":"Utility created successfully!"),u({title:"",utility_type:"other",source_type:"cash",description:"",amount:0,inventory_item:void 0,quantity_used:1,shop:void 0,Extra_Confirmation:"",purpose:"",notes:"",expense_date:new Date().toISOString().split("T")[0]}),M(""),i()}catch(t){let e=t.message||"Failed to save utility";I(e),E.oR.error(e)}finally{z(!1)}}};return l?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex justify-end pointer-events-none",children:(0,a.jsxs)("div",{className:"bg-white w-full max-w-3xl h-full overflow-y-auto shadow-2xl pointer-events-auto",children:[(0,a.jsx)("div",{className:"sticky top-0 bg-white border-b p-6 z-10",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Edit Utility":"Add New Utility"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:t?"Update utility information":"Create a new utility"})]}),(0,a.jsx)(S.$,{variant:"ghost",size:"icon",onClick:i,className:"h-8 w-8",children:(0,a.jsx)(f.A,{className:"h-4 w-4"})})]})}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[D&&(0,a.jsxs)(F.Fc,{className:"border-red-200 bg-red-50",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 text-red-600"}),(0,a.jsx)(F.TN,{className:"text-red-800",children:D})]}),O&&(0,a.jsxs)(F.Fc,{className:"border-green-200 bg-green-50",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 text-green-600"}),(0,a.jsx)(F.TN,{className:"text-green-800",children:O})]}),x.inventory_item&&"inventory"===c.source_type&&(0,a.jsxs)(F.Fc,{className:"border-red-200 bg-red-50",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 text-red-600"}),(0,a.jsx)(F.TN,{className:"text-red-800",children:x.inventory_item})]}),(0,a.jsxs)("form",{onSubmit:L,className:"space-y-6",children:[(0,a.jsxs)(C.Zp,{className:"border-gray-200 shadow-sm",children:[(0,a.jsxs)(C.aR,{className:"bg-gray-50/50",children:[(0,a.jsx)(C.ZB,{className:"text-lg font-semibold text-gray-800",children:"Utility Information"}),(0,a.jsx)(C.BT,{className:"text-gray-600",children:"Enter the core details for the utility"})]}),(0,a.jsx)(C.Wu,{className:"pt-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(k.J,{htmlFor:"title",className:"text-sm font-medium text-gray-700",children:"Title *"}),(0,a.jsx)(A.p,{id:"title",name:"title",value:c.title,onChange:$,placeholder:"Enter utility title",className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0}),x.title&&(0,a.jsxs)("p",{className:"text-xs text-red-600 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-1"})," ",x.title]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"The name or title of the utility"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(k.J,{htmlFor:"utility_type",className:"text-sm font-medium text-gray-700",children:"Utility Type *"}),(0,a.jsx)("select",{id:"utility_type",name:"utility_type",value:c.utility_type,onChange:$,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(x.utility_type?"border-red-500":"border-gray-300"),disabled:null==t?void 0:t.is_inventory_based,required:!0,children:_.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),x.utility_type&&(0,a.jsxs)("p",{className:"text-xs text-red-600 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-1"})," ",x.utility_type]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"The type of utility"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(k.J,{htmlFor:"source_type",className:"text-sm font-medium text-gray-700",children:"Source Type *"}),(0,a.jsx)("select",{id:"source_type",name:"source_type",value:c.source_type,onChange:$,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(x.source_type?"border-red-500":"border-gray-300"),disabled:(null==t?void 0:t.is_inventory_based)||"inventory_usage"===c.utility_type,required:!0,children:w.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),x.source_type&&(0,a.jsxs)("p",{className:"text-xs text-red-600 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-1"})," ",x.source_type]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"The source of the utility (e.g., cash or inventory)"})]}),"inventory"===c.source_type&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(k.J,{htmlFor:"inventory_search",className:"text-sm font-medium text-gray-700",children:"Search Inventory Items"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(b.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)(A.p,{id:"inventory_search",value:q,onChange:e=>{M(e.target.value)},placeholder:"Search by product name or batch number",className:"pl-10 border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),(0,a.jsx)(k.J,{htmlFor:"inventory_item",className:"text-sm font-medium text-gray-700",children:"Inventory Item *"}),(0,a.jsxs)("select",{id:"inventory_item",name:"inventory_item",value:c.inventory_item||"",onChange:$,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(x.inventory_item?"border-red-500":"border-gray-300"),disabled:R||(null==t?void 0:t.is_inventory_based),required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select an inventory item"}),v.length>0?v.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.product_name," (Stock: ",e.available_stock,", Batch: ",e.batch_number||"N/A",")"]},e.id)):(0,a.jsx)("option",{value:"",disabled:!0,children:"No inventory items available"})]}),R&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 flex items-center",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-1 animate-spin"})," ","Loading inventory..."]}),x.inventory_item&&(0,a.jsxs)("p",{className:"text-xs text-red-600 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-1"})," ",x.inventory_item]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Select the inventory item used"})]}),"inventory"===c.source_type&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(k.J,{htmlFor:"quantity_used",className:"text-sm font-medium text-gray-700",children:"Quantity Used *"}),(0,a.jsx)(A.p,{id:"quantity_used",name:"quantity_used",type:"number",value:c.quantity_used,onChange:$,min:"1",className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Enter quantity used",disabled:null==t?void 0:t.is_inventory_based,required:!0}),x.quantity_used&&(0,a.jsxs)("p",{className:"text-xs text-red-600 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-1"})," ",x.quantity_used]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Number of units used from inventory"})]}),"inventory"!==c.source_type&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(k.J,{htmlFor:"amount",className:"text-sm font-medium text-gray-700",children:"Amount (KSH) *"}),(0,a.jsx)(A.p,{id:"amount",name:"amount",type:"number",value:c.amount,onChange:$,min:"0",step:"0.01",className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",placeholder:"Enter amount in KSH",required:!0}),x.amount&&(0,a.jsxs)("p",{className:"text-xs text-red-600 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-1"})," ",x.amount]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"The cost amount in Kenyan Shillings for non-inventory utilities"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(k.J,{htmlFor:"shop",className:"text-sm font-medium text-gray-700",children:"Shop"}),(0,a.jsxs)("select",{id:"shop",name:"shop",value:c.shop||"",onChange:$,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(x.shop?"border-red-500":"border-gray-300"),children:[(0,a.jsx)("option",{value:"",children:"Select a shop"}),d.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.address,")"]},e.id))]}),x.shop&&(0,a.jsxs)("p",{className:"text-xs text-red-600 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-1"})," ",x.shop]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"The shop associated with this utility"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(k.J,{htmlFor:"expense_date",className:"text-sm font-medium text-gray-700",children:"Expense Date *"}),(0,a.jsx)(A.p,{id:"expense_date",name:"expense_date",type:"date",value:c.expense_date,onChange:$,className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500",required:!0}),x.expense_date&&(0,a.jsxs)("p",{className:"text-xs text-red-600 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-1"})," ",x.expense_date]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Date when the expense was incurred"})]}),!c.shop&&(0,a.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,a.jsx)(k.J,{htmlFor:"Extra_Confirmation",className:"text-sm font-medium text-gray-700",children:"Receipt/Reference Number"}),(0,a.jsx)(A.p,{id:"Extra_Confirmation",name:"Extra_Confirmation",value:c.Extra_Confirmation||"",onChange:$,placeholder:"Enter receipt or reference number",className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Optional receipt or reference number for the utility"})]}),(0,a.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,a.jsx)(k.J,{htmlFor:"description",className:"text-sm font-medium text-gray-700",children:"Description *"}),(0,a.jsx)("textarea",{id:"description",name:"description",value:c.description||"",onChange:$,placeholder:"Enter utility description",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,required:!0}),x.description&&(0,a.jsxs)("p",{className:"text-xs text-red-600 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-1"})," ",x.description]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Detailed description of the utility"})]}),(0,a.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,a.jsx)(k.J,{htmlFor:"purpose",className:"text-sm font-medium text-gray-700",children:"Purpose"}),(0,a.jsx)("textarea",{id:"purpose",name:"purpose",value:c.purpose||"",onChange:$,placeholder:"Enter business purpose",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"The business purpose of this utility"})]}),(0,a.jsxs)("div",{className:"space-y-2 col-span-2",children:[(0,a.jsx)(k.J,{htmlFor:"notes",className:"text-sm font-medium text-gray-700",children:"Notes"}),(0,a.jsx)("textarea",{id:"notes",name:"notes",value:c.notes||"",onChange:$,placeholder:"Enter additional notes",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Additional notes about the utility"})]})]})})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,a.jsx)(S.$,{type:"button",variant:"outline",onClick:i,disabled:T,className:"min-w-[100px]",children:"Cancel"}),(0,a.jsx)(S.$,{type:"submit",disabled:T,className:"min-w-[120px] bg-blue-600 hover:bg-blue-700",children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4"}),t?"Update Utility":"Create Utility"]})})]})]})]})]})}):null};var M=s(37108),T=s(5540);let z=e=>{var t,s,l,o;let{shopId:d,filters:c}=e,[u,x]=(0,r.useState)(null),[m,p]=(0,r.useState)(!1),[h,y]=(0,r.useState)(null),[g,f]=(0,r.useState)(0);if((0,r.useEffect)(()=>{(async()=>{p(!0),y(null);try{let e=await v({shop_id:null!=d?d:void 0,start_date:null==c?void 0:c.start_date,end_date:null==c?void 0:c.end_date,user_id:null==c?void 0:c.user_id});x(e)}catch(e){y("Failed to load utility statistics")}finally{p(!1)}})()},[d,null==c?void 0:c.start_date,null==c?void 0:c.end_date,null==c?void 0:c.user_id]),(0,r.useEffect)(()=>{(async()=>{try{var e,t;let s=await (0,T.aF)(),a=Array.isArray(s)?s:null!=(e=s.shops)?e:[];if(a.length>0){let e=a[0].id,s=await (0,T.SY)(e);f(null!=(t=s.total_utility_cash_spent)?t:0)}}catch(e){console.error(e)}})()},[]),m)return(0,a.jsx)("div",{className:"flex justify-center py-4",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-blue-500"})});if(h||!u)return(0,a.jsxs)(F.Fc,{className:"border-red-200 bg-red-50 mb-4",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 text-red-600"}),(0,a.jsx)(F.TN,{className:"text-red-800 text-sm",children:h||"No statistics available"})]});null==(t=_.find(e=>e.value===u.most_used_utility_type))||t.label;let b=null!=(s=u.total_amount_spent)?s:0,j=null!=(l=u.total_inventory_value_used)?l:0,N=e=>e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):e.toLocaleString();return(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[(0,a.jsx)(C.Zp,{className:"border-gray-200 shadow-sm p-3 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"min-w-0 flex-1 mr-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1 truncate",children:"Total Utilities"}),(0,a.jsx)("p",{className:"text-lg font-bold text-gray-900 truncate",children:null!=(o=u.total_utilities)?o:0})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(M.A,{className:"w-5 h-5 text-blue-500"})})]})}),(0,a.jsx)(C.Zp,{className:"border-gray-200 shadow-sm p-3 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"min-w-0 flex-1 mr-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1 truncate",children:"Total Spent"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-blue-600 truncate",children:["KSh ",N(b)]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(i.A,{className:"w-5 h-5 text-blue-500"})})]})}),(0,a.jsx)(C.Zp,{className:"border-gray-200 shadow-sm p-3 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"min-w-0 flex-1 mr-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1 truncate",children:"Inventory Used"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-green-600 truncate",children:["KSh ",N(j)]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-5 h-5 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-2.5 h-2.5 bg-green-500 rounded-full"})})})]})}),(0,a.jsx)(C.Zp,{className:"border-gray-200 shadow-sm p-3 hover:shadow-md transition-shadow",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"min-w-0 flex-1 mr-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-500 mb-1 truncate",children:"Cash Spent"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-purple-600 truncate",children:["KSh ",N(g)]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(i.A,{className:"w-5 h-5 text-purple-500"})})]})})]})};var R=s(13717),U=s(62525);let D=(0,s(19946).A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),I=e=>{let{utilities:t,isLoading:s,totalCount:r,page:i,pageSize:l,onEdit:n,onDelete:o,onRestoreInventory:d,onPageChange:c}=e,u=Math.ceil(r/l),x=e=>e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):e.toLocaleString(),m=e=>new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"});return(0,a.jsxs)(C.Zp,{className:"border border-gray-200 rounded-xl shadow-lg max-w-7xl mx-auto bg-white",children:[(0,a.jsxs)(C.aR,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-t-xl",children:[(0,a.jsx)(C.ZB,{className:"text-lg font-semibold text-gray-800",children:"Utilities Dashboard"}),(0,a.jsx)(C.BT,{className:"text-sm text-gray-600",children:"Manage your recent expenses and inventory"})]}),(0,a.jsxs)(C.Wu,{className:"p-0",children:[s?(0,a.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,a.jsx)(j.A,{className:"h-8 w-8 text-blue-500 animate-spin"})}):0===t.length?(0,a.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"No utilities found."}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"Try adjusting your filters or add a new utility to get started."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"block md:hidden",children:(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:t.map(e=>(0,a.jsxs)("div",{className:"p-4 hover:bg-gray-50 transition-colors duration-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:e.title}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[e.utility_type_display," •"," ",e.source_type_display]})]}),(0,a.jsxs)("div",{className:"flex space-x-1 ml-3",children:[(0,a.jsx)(S.$,{variant:"outline",size:"icon",onClick:()=>n(e),className:"h-8 w-8 border-gray-300 text-indigo-600 hover:bg-indigo-50 hover:text-indigo-800 transition-colors",title:"Edit utility",children:(0,a.jsx)(R.A,{className:"h-4 w-4"})}),(0,a.jsx)(S.$,{variant:"outline",size:"icon",onClick:()=>o(e.id),className:"h-8 w-8 border-gray-300 text-red-600 hover:bg-red-50 hover:text-red-800 transition-colors",title:"Delete utility",children:(0,a.jsx)(U.A,{className:"h-4 w-4"})}),e.is_inventory_based&&e.inventory_deducted&&(0,a.jsx)(S.$,{variant:"outline",size:"icon",onClick:()=>d(e.id),className:"h-8 w-8 border-gray-300 text-green-600 hover:bg-green-50 hover:text-green-800 transition-colors",title:"Restore inventory",children:(0,a.jsx)(D,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("span",{className:"text-sm font-semibold text-blue-600",children:["KSh ",x(e.amount)]}),(0,a.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:e.shop_name||"No shop"})]}),(0,a.jsx)("span",{className:"text-xs text-gray-500 font-medium",children:m(e.expense_date)})]})]},e.id))})}),(0,a.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,a.jsxs)("table",{className:" mx-4 min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Title"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Type"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Source"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Shop"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900",children:(0,a.jsx)("div",{className:"max-w-md truncate",title:e.title,children:e.title})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:e.utility_type_display}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:e.source_type_display}),(0,a.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-semibold text-blue-600",children:["KSh ",x(e.amount)]}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:(0,a.jsx)("div",{className:"max-w-32 truncate",title:e.shop_name||"N/A",children:e.shop_name||"N/A"})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:m(e.expense_date)})]},e.id))})]})})]}),r>l&&(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center px-4 py-3 bg-gray-50 border-t border-gray-200 rounded-b-xl gap-3",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Showing"," ",(0,a.jsxs)("span",{className:"font-semibold",children:[(i-1)*l+1,"–",Math.min(i*l,r)]})," ","of ",(0,a.jsx)("span",{className:"font-semibold",children:r})," utilities"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(S.$,{variant:"outline",onClick:()=>c(Math.max(i-1,1)),disabled:1===i,size:"sm",className:"text-sm px-3 h-9 border-gray-300 hover:bg-gray-100",children:"Previous"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 bg-white border border-gray-300 rounded-lg px-3 py-1.5",children:["Page ",i," of ",u]}),(0,a.jsx)(S.$,{variant:"outline",onClick:()=>c(Math.min(i+1,u)),disabled:i===u,size:"sm",className:"text-sm px-3 h-9 border-gray-300 hover:bg-gray-100",children:"Next"})]})]})]})]})};function O(){let[e,t]=(0,r.useState)([]),[s,c]=(0,r.useState)(0),[u,y]=(0,r.useState)(1),[v]=(0,r.useState)(10),[f,b]=(0,r.useState)({}),[j,N]=(0,r.useState)([]),[M,R]=(0,r.useState)(null),[U,D]=(0,r.useState)(null),[O,P]=(0,r.useState)(!1),[$,L]=(0,r.useState)(null),[J,V]=(0,r.useState)(""),[Z,K]=(0,r.useState)(!1),[B,H]=(0,r.useState)(null),[W,G]=(0,r.useState)({}),[Q,X]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{let e=await (0,T.KM)();N(e.results||[])}catch(e){L("Failed to load shops")}})()},[]),(0,r.useEffect)(()=>{(async()=>{if(M)try{let e=await (0,T.Nx)(M);D(e)}catch(e){L("Failed to load shop details"),D(null)}else D(null)})()},[M]),(0,r.useEffect)(()=>{(async()=>{P(!0),L(null),V("");try{let e=await x({...f,shop:M||void 0,page:u,page_size:v,ordering:"-created_at,-expense_date"});t(e.results),c(e.count)}catch(e){L("Failed to load utilities")}finally{P(!1)}})()},[f,u,v,M]);let Y=e=>{let{name:t,value:s}=e.target;G(e=>({...e,[t]:""===s?void 0:s}))},ee=async()=>{let e=await x({...f,shop:M||void 0,page:u,page_size:v,ordering:"-created_at,-expense_date"});t(e.results),c(e.count)},et=async e=>{try{await m(e),V("Utility created successfully!"),E.oR.success("Utility created successfully!"),K(!1),await ee()}catch(e){L("Failed to create utility"),E.oR.error("Failed to create utility")}},es=async(e,t)=>{try{let s={id:e,...t};await p(e,s),V("Utility updated successfully!"),E.oR.success("Utility updated successfully!"),H(null),K(!1),await ee()}catch(e){L("Failed to update utility"),E.oR.error("Failed to update utility")}},ea=async e=>{if(confirm("Are you sure you want to delete this utility?"))try{await h(e),V("Utility deleted successfully!"),E.oR.success("Utility deleted successfully!"),await ee()}catch(e){L("Failed to delete utility"),E.oR.error("Failed to delete utility")}},er=async e=>{if(confirm("Are you sure you want to restore inventory for this utility?"))try{let t=await g(e);V(t.success||"Inventory restored successfully!"),E.oR.success(t.success||"Inventory restored successfully!"),await ee()}catch(e){L("Failed to restore inventory"),E.oR.error("Failed to restore inventory")}},ei=Object.keys(f).some(e=>f[e])||M;return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"mx-auto px-3 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"py-4 sm:py-6",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"bg-blue-600 p-2 sm:p-3 rounded-lg shadow-sm",children:(0,a.jsx)(i.A,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Utility Management"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 mt-0.5",children:"Manage utility expenses and inventory"})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 max-w-max sm:w-auto",children:(0,a.jsxs)(S.$,{onClick:()=>{H(null),K(!0)},size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-1 text-xs px-2 py-1 h-7",children:[(0,a.jsx)(l.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Add Utility"}),(0,a.jsx)("span",{className:"sm:hidden",children:"Add"})]})})]})})})}),(0,a.jsxs)("div",{className:"mx-auto px-3 sm:px-6 lg:px-8 py-4 sm:py-6",children:[$&&(0,a.jsxs)(F.Fc,{className:"border-red-200 bg-red-50 mb-4",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 text-red-600"}),(0,a.jsx)(F.TN,{className:"text-red-800 text-sm",children:$})]}),J&&(0,a.jsxs)(F.Fc,{className:"border-green-200 bg-green-50 mb-4",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 text-green-600"}),(0,a.jsx)(F.TN,{className:"text-green-800 text-sm",children:J})]}),(0,a.jsx)(z,{shopId:M,filters:f}),(0,a.jsx)("div",{className:" flex justify-start items-center w-full py-3 mb-3 border-t border-b border-gray-200 bg-gray-50 rounded-md shadow-sm",children:(0,a.jsxs)(S.$,{variant:"outline",size:"sm",onClick:()=>X(!0),className:" mx-4 flex items-start gap-1 text-xs px-3 py-1.5 h-8 border border-gray-300 shadow-sm hover:bg-gray-100 transition",children:[(0,a.jsx)(d.A,{className:"h-3 w-3"}),"Apply Filters",ei&&(0,a.jsx)("span",{className:"bg-blue-100 text-blue-600 text-[10px] px-1 py-0.5 rounded-full",children:"•"})]})}),(0,a.jsxs)(C.Zp,{className:"border-gray-200 shadow-sm mb-3 ".concat(Q?"block":"hidden"),children:[(0,a.jsx)(C.aR,{className:"bg-gray-50/50 p-2 sm:p-3",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.A,{className:"h-3 w-3 text-blue-600"}),(0,a.jsx)(C.ZB,{className:"text-xs font-medium text-gray-800",children:"Filters"})]})})}),(0,a.jsxs)(C.Wu,{className:"p-2 sm:p-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(k.J,{htmlFor:"search",className:"text-xs font-medium text-gray-700",children:"Search"}),(0,a.jsx)(A.p,{id:"search",name:"search",value:W.search||"",onChange:Y,placeholder:"Search...",className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 text-xs h-7"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(k.J,{htmlFor:"shop",className:"text-xs font-medium text-gray-700",children:"Shop"}),(0,a.jsxs)("select",{id:"shop",name:"shop",value:W.shop||"",onChange:e=>G(t=>({...t,shop:e.target.value?Number(e.target.value):void 0})),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-7",children:[(0,a.jsx)("option",{value:"",children:"All"}),j.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(k.J,{htmlFor:"utility_type",className:"text-xs font-medium text-gray-700",children:"Type"}),(0,a.jsxs)("select",{id:"utility_type",name:"utility_type",value:W.utility_type||"",onChange:Y,className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-7",children:[(0,a.jsx)("option",{value:"",children:"All"}),_.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(k.J,{htmlFor:"source_type",className:"text-xs font-medium text-gray-700",children:"Source"}),(0,a.jsxs)("select",{id:"source_type",name:"source_type",value:W.source_type||"",onChange:Y,className:"w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-7",children:[(0,a.jsx)("option",{value:"",children:"All"}),w.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-3",children:[(0,a.jsx)(S.$,{variant:"ghost",size:"sm",onClick:()=>{G(f),X(!1)},className:"text-xs",children:"Cancel"}),(0,a.jsx)(S.$,{size:"sm",onClick:()=>{b(W),y(1),X(!1)},className:"bg-blue-600 hover:bg-blue-700 text-white text-xs",children:"Apply"})]})]})]}),U&&(0,a.jsx)(C.Zp,{className:"border-blue-200 bg-blue-50/30 mb-4 sm:hidden",children:(0,a.jsx)(C.Wu,{className:"p-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-xs font-medium text-blue-800",children:["Viewing: ",U.name]}),(0,a.jsxs)("p",{className:"text-xs text-blue-600 mt-0.5",children:[s," utilities found"]})]}),(0,a.jsx)(S.$,{variant:"ghost",size:"sm",onClick:()=>R(null),className:"text-xs text-blue-600",children:"View All"})]})})}),(0,a.jsx)(I,{utilities:e,isLoading:O,totalCount:s,page:u,pageSize:v,onEdit:e=>{H(e),K(!0)},onDelete:ea,onRestoreInventory:er,onPageChange:y})]}),(0,a.jsx)(q,{initialData:B||void 0,onSuccess:B?e=>es(B.id,e):et,onClose:()=>{K(!1),H(null)},isEmbedded:Z,shops:j})]})}},37108:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},40646:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},40968:(e,t,s)=>{"use strict";s.d(t,{b:()=>n});var a=s(12115),r=s(63655),i=s(95155),l=a.forwardRef((e,t)=>(0,i.jsx)(r.sG.label,{...e,ref:t,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||(null==(s=e.onMouseDown)||s.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));l.displayName="Label";var n=l},47924:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},49026:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>n,TN:()=>o});var a=s(95155);s(12115);var r=s(74466),i=s(53999);let l=(0,r.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,i.cn)(l({variant:s}),t),...r})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:(0,i.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...s})}},51154:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},53999:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var a=s(52596),r=s(39688);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},54416:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},55868:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},62525:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},63655:(e,t,s)=>{"use strict";s.d(t,{hO:()=>o,sG:()=>n});var a=s(12115),r=s(47650),i=s(99708),l=s(95155),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let s=(0,i.TL)(`Primitive.${t}`),r=a.forwardRef((e,a)=>{let{asChild:r,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(r?s:t,{...i,ref:a})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function o(e,t){e&&r.flushSync(()=>e.dispatchEvent(t))}},64032:(e,t,s)=>{Promise.resolve().then(s.bind(s,20651))},66932:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},74466:(e,t,s)=>{"use strict";s.d(t,{F:()=>l});var a=s(52596);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=a.$,l=(e,t)=>s=>{var a;if((null==t?void 0:t.variants)==null)return i(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:l,defaultVariants:n}=t,o=Object.keys(l).map(e=>{let t=null==s?void 0:s[e],a=null==n?void 0:n[e];if(null===t)return null;let i=r(t)||r(a);return l[e][i]}),d=s&&Object.entries(s).reduce((e,t)=>{let[s,a]=t;return void 0===a||(e[s]=a),e},{});return i(e,o,null==t||null==(a=t.compoundVariants)?void 0:a.reduce((e,t)=>{let{class:s,className:a,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...n,...d}[t]):({...n,...d})[t]===s})?[...e,s,a]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}},82714:(e,t,s)=>{"use strict";s.d(t,{J:()=>l});var a=s(95155);s(12115);var r=s(40968),i=s(53999);function l(e){let{className:t,...s}=e;return(0,a.jsx)(r.b,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}},84616:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},88482:(e,t,s)=>{"use strict";s.d(t,{BT:()=>o,Wu:()=>d,ZB:()=>n,Zp:()=>i,aR:()=>l});var a=s(95155);s(12115);var r=s(53999);function i(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...s})}},89852:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var a=s(95155);s(12115);var r=s(53999);function i(e){let{className:t,type:s,...i}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...i})}},97168:(e,t,s)=>{"use strict";s.d(t,{$:()=>o,r:()=>n});var a=s(95155);s(12115);var r=s(99708),i=s(74466),l=s(53999);let n=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:s,size:i,asChild:o=!1,...d}=e,c=o?r.DX:"button";return(0,a.jsx)(c,{"data-slot":"button",className:(0,l.cn)(n({variant:s,size:i,className:t})),...d})}},99708:(e,t,s)=>{"use strict";s.d(t,{DX:()=>n,Dc:()=>d,TL:()=>l});var a=s(12115),r=s(6101),i=s(95155);function l(e){let t=function(e){let t=a.forwardRef((e,t)=>{let{children:s,...i}=e;if(a.isValidElement(s)){var l;let e,n,o=(l=s,(n=(e=Object.getOwnPropertyDescriptor(l.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.ref:(n=(e=Object.getOwnPropertyDescriptor(l,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?l.props.ref:l.props.ref||l.ref),d=function(e,t){let s={...t};for(let a in t){let r=e[a],i=t[a];/^on[A-Z]/.test(a)?r&&i?s[a]=(...e)=>{let t=i(...e);return r(...e),t}:r&&(s[a]=r):"style"===a?s[a]={...r,...i}:"className"===a&&(s[a]=[r,i].filter(Boolean).join(" "))}return{...e,...s}}(i,s.props);return s.type!==a.Fragment&&(d.ref=t?(0,r.t)(t,o):o),a.cloneElement(s,d)}return a.Children.count(s)>1?a.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),s=a.forwardRef((e,s)=>{let{children:r,...l}=e,n=a.Children.toArray(r),o=n.find(c);if(o){let e=o.props.children,r=n.map(t=>t!==o?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,i.jsx)(t,{...l,ref:s,children:a.isValidElement(e)?a.cloneElement(e,void 0,r):null})}return(0,i.jsx)(t,{...l,ref:s,children:r})});return s.displayName=`${e}.Slot`,s}var n=l("Slot"),o=Symbol("radix.slottable");function d(e){let t=({children:e})=>(0,i.jsx)(i.Fragment,{children:e});return t.displayName=`${e}.Slottable`,t.__radixId=o,t}function c(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}}},e=>{e.O(0,[6586,4277,8543,6373,1778,8441,5964,7358],()=>e(e.s=64032)),_N_E=e.O()}]);